var documenterSearchIndex = {"docs":
[{"location":"#MachineLearning.jl","page":"MachineLearning.jl","title":"MachineLearning.jl","text":"","category":"section"},{"location":"","page":"MachineLearning.jl","title":"MachineLearning.jl","text":"Documentation for MachineLearning.jl","category":"page"},{"location":"basic-idea/#Basic-idea","page":"Basic idea","title":"Basic idea","text":"","category":"section"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"機器學習的核心是：假設有一個函數 f 可以解決問題，我們要試圖找出函數 f 盡可能的跟 f 輸出接近","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"現在假設有一個函數 actual(x) = 4x + 2，我們用 Julia 寫成","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"actual(x) = 4x + 2","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"接著我們要有訓練資料跟驗證資料，在現在的簡單情境下，我們可以用 actual 函數生成結果","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"using Flux: Data.DataLoader\n\nx_train, x_test = [0 1 2 3 4 5], [6 7 8 9 10]\ny_train, y_test = actual.(x_train), actual.(x_test)\ndata = DataLoader((x_train, y_train), shuffle=true)","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"接著我們建立模型跟誤差函數，模型就是 f，誤差函數的意思則是 f(x) 的結果跟真實的 y 的差距。誤差函數有很多計算方式，這裡我們用 MSE 函數。Dense(1, 1) 表示輸入為一個，輸出為一個的函數，由於有 Weight 跟 Bias，我們的 model 正好有兩個參數，我們最後會看到這兩個參數經過訓練之後會趨近 4 跟 2","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"using Flux\n\nmodel = Dense(1, 1)\nloss(x, y) = Flux.Losses.mse(model(x), y)","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"接著我們要選擇學習優化器 optimizer(也有拼作 optimiser 的)，這裏我們選用 stochastic gradient decent，他是往參數梯度的方向去更新權重，參數可以用 params(model) 得到。最後就是放到 @epochs 裡面去跑","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"using Flux: train!, @epochs\n\nopt = Descent()\n\n@epochs 40 begin\n  train!(loss, params(model), data, opt)\n  @show(loss(x_test, y_test))\n  @show(params(model))\nend","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"我們把參數跟誤差用 @show 印出來，可以得到以下結果","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"[ Info: Epoch 1\nloss(x_test, y_test) = 62.672203f0\nparams(model) = Params([Float32[4.9183693;;], Float32[2.46236]])\n[ Info: Epoch 2\nloss(x_test, y_test) = 134.20432f0\nparams(model) = Params([Float32[2.2584872;;], Float32[4.6122694]])\n[ Info: Epoch 3\nloss(x_test, y_test) = 204.82014f0\nparams(model) = Params([Float32[5.521385;;], Float32[3.977801]])\n...\n[ Info: Epoch 38\nloss(x_test, y_test) = 1.6675525f-5\nparams(model) = Params([Float32[4.0004225;;], Float32[2.0006583]])\n[ Info: Epoch 39\nloss(x_test, y_test) = 1.2968558f-6\nparams(model) = Params([Float32[4.000121;;], Float32[2.000157]])\n[ Info: Epoch 40\nloss(x_test, y_test) = 1.7670478f-6\nparams(model) = Params([Float32[4.0001535;;], Float32[2.000083]])","category":"page"},{"location":"basic-idea/","page":"Basic idea","title":"Basic idea","text":"可以看到最後參數確實是接近 4 跟 2 的","category":"page"}]
}
